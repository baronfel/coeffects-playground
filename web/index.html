<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width" />
  <title>Coeffects</title>
  <script src="//code.jquery.com/jquery-2.1.4.min.js"></script>
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha256-KXn5puMvxCw+dAYznun+drMdG1IFl3agK0p/pqT9KAo= sha512-2e8qq0ETcfWRI4HJBzQiA3UoyFk6tbNyG+qSaIBZLyW9Xf3sWZHN/lxe9fTh1U45DpPf07yj94KsUHHWe4Yk1A==" crossorigin="anonymous"></script>
  <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-7s5uDGW3AHqw6xtJmNNtr+OBRJUlgkNJEo78P4b0yRw= sha512-nNo+yCHEyn0smMxSswnf/OnX6/KwJuZTlNZBjauKhTK0c+zT+q5JOCx0UFhXQ6rJR9jg6Es8gPuD2uZcYDLqSw==" crossorigin="anonymous">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
  <script src='//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({ TeX: { extensions: ["color.js"] }});
  </script>  
  <link rel="stylesheet" href="style.css" />
  <script src="interactive.js" type="text/javascript"></script>
  <script src="tips.js" type="text/javascript"></script>
  <script src="script.js" type="text/javascript"></script>
</head>
<body>
  <div id="header">
  <div class="container">
    <h1>Coeffects: <em>Context-aware programming languages</em></h1>
  </div>
  </div>
  <nav class="navbar" data-spy="affix" data-offset-top="100">
    <div class="container">
      <div class="navbar-header">
       <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#nb" aria-expanded="false">
         <span class="sr-only">Toggle navigation</span>
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
       </button>
      </div>
      <div class="collapse navbar-collapse" id="nb">
       <ul class="nav navbar-nav">
         <li><a href="#">Home</a></li>
         <li><a href="#">About</a></li>
         <li><a href="#">Demos</a></li>
       </ul>
       <ul class="nav navbar-nav navbar-right ia-ui-menu">
         <li class="ia-choice" data-ia-key="ch1" data-ia-ui-kind="box" data-ia-show="" data-ia-hide="intro-motivation intro-theory langs-info"><a href="#">Short</a></li>
         <li class="ia-choice" data-ia-key="ch2" data-ia-ui-kind="box" data-ia-show="intro-motivation" data-ia-hide="intro-theory langs-info"><a href="#">Practice</a></li>
         <li class="ia-choice" data-ia-key="ch3" data-ia-ui-kind="box" data-ia-show="intro-theory langs-info" data-ia-hide="intro-motivation"><a href="#">Theory</a></li>
         <li class="ia-choice" data-ia-key="ch4" data-ia-ui-kind="box" data-ia-show="intro-motivation intro-theory langs-info" data-ia-hide=""><a href="#">All</a></li>
       </ul>
      </div>
    </div>
  </nav>      
  
  <div class="below-nav outline">
  <div class="container">
  <div class="col-sm-7">
    
    >>>>
    
    Coeffects are [Tomas Petricek's](http://tomasp.net/academic) PhD research project.
    They are a programming language abstraction for understanding how programs access the 
    _context_ or _environment_ in which they execute.
    
    The context may be resources on your mobile phone (battery, GPS location or a network printer), 
    IoT devices in a physical neighborhood or historical stock prices. By understanding the neighborhood
    or history, a _context-aware_ programming language can catch bugs earlier and run more efficiently.
    
    This page is an interactive tutorial that shows a prototype implementation of
    coeffects in a browser. You can play with two simple context-aware languages, see how the 
    type checking works and how context-aware programs run.

    This page is also an experiment in presenting programming language research. It is a live
    environment where you can play with the theory using the power of new media, rather than 
    staring at a dead pieces of wood (although we [have those too](about.html)).
    
    <<<<
    
  </div>
  <div class="col-sm-5">
    <p>We hide some details by default to keep the tutorial shorter, but you can get them back if you want!
    </p>
  
    <div class="row ia-ui-boxes">
      <div class="col-md-6">
        <div class="ia-ui-box ia-choice" data-ia-key="ch1" data-ia-ui-kind="box" data-ia-show="" data-ia-hide="intro-motivation intro-theory langs-info">
          <p><i class="fa fa-thumbs-up"></i><strong>Short is good!</strong> You can always come back.</p></div>
      </div>
      <div class="col-md-6">
        <div class="ia-ui-box ia-choice" data-ia-key="ch2" data-ia-ui-kind="box" data-ia-show="intro-motivation" data-ia-hide="intro-theory langs-info">
          <p><i class="fa fa-industry"></i><strong>I'm practical!</strong> Show me more examples.</p></div>
      </div>
    </div>
    <div class="row ia-ui-boxes">
      <div class="col-md-6">
        <div class="ia-ui-box ia-choice" data-ia-key="ch3" data-ia-ui-kind="box" data-ia-show="intro-theory langs-info" data-ia-hide="intro-motivation">
          <p><i class="fa fa-university"></i><strong>Love theory!</strong> Give me all the equations.</p></div>
      </div>
      <div class="col-md-6">
        <div class="ia-ui-box ia-choice" data-ia-key="ch4" data-ia-ui-kind="box" data-ia-show="intro-motivation intro-theory langs-info" data-ia-hide="">
          <p><i class="fa fa-search"></i><strong>Show me all!</strong> Time is not an issue.</p></div>
      </div>
    </div>

  </div>
  </div>
  </div>
  
  <div style="display:none">
    \[
      \definecolor{leff}{RGB}{255,107,102}
      \definecolor{lcoeff}{RGB}{78,206,88}
      \definecolor{ltyp}{RGB}{255,202,79}
      \definecolor{lkvd}{RGB}{127,165,255}
      
      \definecolor{eff}{RGB}{177,35,43}
      \definecolor{coeff}{RGB}{35,177,53}
      \definecolor{typ}{RGB}{177,93,43}
      \definecolor{expr}{RGB}{0,0,0}
      \definecolor{kvd}{RGB}{0,45,177}
      \definecolor{num}{RGB}{43,177,93}      
    \]
  </div>
  <div class="body container">
    <div class="row">
    <div class="hidden-sm col-md-1"></div>
    <div class="col-sm-8 col-md-7 rside">
      <h2>
        What problem are coeffects solving?<br />
        <span class="ia-choice ia-ui-circle" data-ia-undoable="true" data-ia-key="ch5" data-ia-ui-kind="circle" data-ia-show="intro-motivation" data-ia-hide=""
          title="Click here to see additional &#10;practical motivation for coeffects">
          <i class="fa fa-industry"></i>
        </span>
        <span class="ia-choice ia-ui-circle" data-ia-undoable="true" data-ia-key="ch6" data-ia-ui-kind="circle" data-ia-show="intro-theory" data-ia-hide=""
          title="Click here to learn more about &#10;the theory and related work">
          <i class="fa fa-university"></i>
        </span>
      </h2>

      >>>>
      Programming languages evolve to reflect the changes in the computing ecosystem.
      The next big challenge for programming language designers is building languages that 
      understand the _context in which programs run_.
        
      This challenge is not easy to see. We are so used to work with context using the current
      cumbersome methods that we do not even _see that there is an issue_. We also do not
      realize that many programming features related to _context_ can be caputred by the
      a simple _unified abstraction_. This is what coeffects do!

      <div class="ia-choice ia-ui-bar-left" data-ia-undoable="true" data-ia-key="ch5" data-ia-ui-kind="circle" data-ia-ui-prop="border-color" data-ia-show="intro-motivation" data-ia-hide="">
      
      What are some examples of context-aware computations?
      
       - In cross-platform code, the functions available on different platforms are a
         context. You can use `#if`. If you get this wrong, your code won't even compile!     
         
       - In the [Game of Life](https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life) or 
         [weather simulations](https://en.wikipedia.org/wiki/Stencil_code), each cell in a grid
         accesses neighboring cells. But do you know how many neighbors it needs?

      </div>
      <<<<      
    </div>
  </div>
  <div class="row ia" data-ia-key="intro-motivation" data-ia-mode="long">
    <div class="col-sm-6">
      >>>>
          [hide]
          type Cache() =
            member x.Contains(key:string) = false
            member x.Get(key:string) = ""
            member x.Set(key:string, value:string) = ()
            
          open System
          let cache = new Cache()
    
      ### Cross-platformn caching

      Say you need a function that caches values in an in-memory dictionary, or using
      a local file system when it is available. Using `#if`, you can write:

          let readFromCache key f =
          
            // Read value from memory or disk
            if cache.Contains(key) then 
              cache.Get(key)
          #if LOCAL_FILE_SYSTEM
            elif File.Exists(key) then 
              File.ReadAllText(key)              
          #endif
          
            // Calculate and cache the value
            else
              let result = f()
              cache.Set(key, result)
          #if LOCAL_FILE_SYSTEM
              File.WriteAllText(key, result)
          #endif    
              result

      
      You could refactor the code to make it less ugly, but the issue will not go away.
      As you need to target more and more platforms, the combinations of `#if` flags grow
      exponentially and it is hard to know that all configurations even compile.
      
      Ideally, the programming language would understand which functions need what capabilities
      and it would automatically check on which platforms can your code run.      
      <<<<
    </div>
    <div class="col-sm-6">
      
      >>>>
          [hide]
          let input = [| 0 |]
          let output = [| 0 |]
          let cursor = 0
          
      ### Stencil computations
      
      In stencil computations, we calcualte value for each element of a grid or mesh based on its
      neighborhood. This is useful in simulations in fluid dynamics or weather modelling. 
      
      A simple example is Conway's Game of Life or other cellural automata. The following example
      implements the [rule 110](https://en.wikipedia.org/wiki/Rule_110) (`arr.[x]` accesses x<sup>th</sup>
      element of the array and `cursor` is the current position):

          let sum = input.[cursor-1] + 
            input.[cursor] + input.[cursor+1] 
            
          if sum = 2 || (sum = 1 && 
              input.[cursor-1] = 0)
            then output.[cursor] <- 1 
            else output.[cursor] <- 0 

      <table id='rule110' style="margin:-10px 20px 5px 20px; overflow:hidden;"></table>
      <div style="text-align:right;"><button id='rule110btn' class="btn" style="width:60px;margin:0px 20px 5px 0px">Run</button></div>
      
      This automata looks at one item on the left and one item on the right. Knowing this is important
      for correctly handling border conditions. If the compiler knew the access pattern, it could
      check this and it could also pre-allocate the necessary space and produce more efficient code,
      especially when compiling for a GPU.
      <<<<
      
    </div>
  </div>
  <div class="row new-section">
    <div class="col-md-7">
      <div class="ia-slides" id="judgement-slides">
      >>>>
      <div class="slide">
      
      ### Simple type systems
      
      To understand effects and coeffects, let's look at how their type systems work. 
      In langauges like F#, the following holds:
      
      $$$
      x:{\color{ltyp} \text{int}},~ y:{\color{ltyp} \text{int}} \vdash x+y : {\color{ltyp} \text{int}}
      
      This says that in a _context_ with variablex $x$ and $y$ of type $\color{ltyp}\text{int}$, the
      type of expression $x+y$ is also $\color{ltyp}\text{int}$. The context on the left of $\vdash$
      is important! If the variables $x$ and $y$ had incompatible types, this would not be well-typed!
            
      </div><div class="slide">
      
      ### Effect systems
      
      The type of expressions with side-effect is $\color{ltyp}\text{unit}$, which does not tell 
      us very much! Effect systems add one more component:
      
      $$$
      hello : {\color{ltyp} \text{string}} \vdash {\color{lkvd} \text{print}}~hello : {\color{ltyp} \text{unit}} {\scriptsize \;\&\;} {\color{leff} \{ \text{io} \} }
      
      Effect systems understand built-in functions like ${\color{lkvd} \text{print}}$ and they infer
      not just the type of an expression, but also an _effect_. Here ${\color{leff} \{ \text{io} \} }$
      means that the expression requires I/O access but not, for example, direct access to mutable memory.
      
      </div><div class="slide">
      
      ### Coeffect systems
      
      Coeffects add an annotation to the _context_ of an expression. For example, checking whether we
      missed a deadline returns $\color{ltyp} \text{bool}$ and requires a set of resources
      $\color{lcoeff} \{ \text{clock} \}$:
      
      $$$
      deadline : {\color{ltyp} \text{time}} {\scriptsize \;@\;} {\color{lcoeff} \{ \text{clock} \} } 
        \vdash {\color{lkvd} \text{now}} \geq deadline : {\color{ltyp} \text{bool}}
      
      Coeffects can do more though. We can add requirements to the whole context (as here), but 
      also to individual variables. We will do this later for checking dataflow computations.
      
      </div><div class="slide">
      
      ### Type systems side-by-side
      
      <table>
      <tr><td style="padding-right:20px">
        
      $$$
      \Gamma \vdash e : {\color{ltyp} \tau}

      </td><td>
        
      In standard type systems, we say that given variables in $\Gamma$, 
      an expression $e$ has a type ${\color{ltyp} \tau}$:
      
      </td></tr><tr><td style="padding-right:20px">
      
      $$$
      \Gamma \vdash e : {\color{ltyp} \tau} {\scriptsize \;\&\;} {\color{leff} r}
      
      </td><td>
      
      Effect systems add annotation to the result. Given variables in $\Gamma$, 
      an expression $e$ has a type ${\color{ltyp} \tau}$ and an _effect_ ${\color{leff} r}$:
      
      </td></tr><tr><td style="padding-right:20px">
    
      $$$
      \Gamma {\scriptsize \;@\;} {\color{lcoeff} r} \vdash e : {\color{ltyp} \tau}
      
      </td><td>
    
      Coeffect systems say more about the context. Given a variables in $\Gamma$
      and additioonal context ${\color{lcoeff} r}$ an expression $e$ has a type ${\color{ltyp} \tau}$:
      
      </td></tr></table>      
      </div>
      <<<<
      </div>  
    </div>
    <div class="col-md-5">
      >>>>
      <div class="ia-choice ia-ui-bar-right" data-ia-undoable="true" data-ia-key="ch6" data-ia-ui-kind="circle" data-ia-ui-prop="border-color" data-ia-show="intro-theory" data-ia-hide="">

      _Coeffects_ are the <abbr title="In the category-theoretial sense, but there are interesting subtle issues!">dual</abbr> 
      of _effects_. Effects represent what your program _does to the world_ while coeffects track 
      what your program _requires from the world_. 
      
      Writing to a console is an I/O effect. You modify the world. If your program reads the 
      current time, it is a coeffect. The environment has to provide a clock. 
      
      One difference between effects and coeffects is that coeffects can be satisfied in multiple 
      different ways. If the device visitng your client/server application does not have clock, 
      the coeffect can use clock available from the server.
      
      You can see the duality of effects and coeffects when you look at their _type systems_, but
      it also affects the _semantics_. That is, how context-aware programs run.
      
      </div>
      <<<<
    </div>
  </div>
  
  <div class="row ia" data-ia-key="intro-theory" data-ia-mode="long">
    >>>>    
    <div class="col-sm-6 col-md-4">
      
    ### Lambda abstraction
      
    In effect systems, the effects of function body are always <abbr title="Ross Tate (2013) calls 
    this producer effect systems.">delayed</abbr>. A printing inside function body will happen when the 
    function is executed. Coeffects are different. 
    
    Say we have a function that requires a clock. We
    construct it on the server and then send it to the client. The clock can come from the declaration
    side (server) or from the call side (client). Scroll to [coeffect type systems](#typesystem) 
    for the details.
  
    </div><div class="col-sm-6 col-md-4">
      
    ### Structural coeffects
    
    Coeffects can be associated with the whole context, but they can also talk about 
    _individual variables_. For example, we can track whether a variable is used (live) 
    or not (dead):
    
    $$$
    x : {\color{typ} \text{int}}, y : {\color{typ} \text{int}} {\scriptsize \;@\;} 
      {\color{coeff} \langle \sf L, \sf D \rangle } 
      \vdash x : {\color{typ} \text{int}}
    
    Here, the coeffect is a _vector_ of annotations and we see the $x$ is live but 
    $y$ is dead. The compiler can then eliminate dead variables!

    </div><div class="col-sm-12 col-md-4">
      
    ### Comonadic semantics
    
    Effectful computations can be <abbr title="This famous result is due to Moggi (1991)">modelled using monads</abbr>.
    A function $\tau_1 \rightarrow \tau_2$ with side effects becomes $\tau_1 \rightarrow {\color{eff} M}\tau_2$ 
    where the monad ${\color{eff} M}$ tracks the additional effects as part of the result.
    
    Context-aware computations can be similarly <abbr title="This has first been discovered by Uustalu and 
      Vene (2008)">modelled using comonads</abbr>. A function that requires additional context becomes
    ${\color{coeff} C} \tau_1 \rightarrow \tau_2$ where the comonad ${\color{coeff} C}$ captures the
    additional context.
    
    </div>
    <<<<
  </div>  
  
  <div class="row new-section">
    <div class="hidden-sm col-md-3"></div>
    <div class="col-sm-12 col-md-9 lside">  
    <h2>
      Two coeffect languages<br />
      <span class="ia-choice ia-ui-circle" data-ia-undoable="true" data-ia-key="ch7" data-ia-ui-kind="circle" data-ia-show="langs-info" data-ia-hide=""
        title="Click here to learn more about &#10;how the coeffect playground works">
        <i class="fa fa-search"></i>
      </span>
    </h2>
    >>>>
    
    <div class="row"><div class="col-sm-6">      
    <h3 style="margin-top:0px">Implicit parameters</h3>
    
    Here, you can play with two simple coeffect languages. A language with 
    <abbr title="This is inspired by Haskell&quote;s implicit parameters introduced by Lewis et al. (2000)">implicit 
    parameters</abbr> shows how coeffects track additional contextual information such as
    available resources (GPS, network printer) or available device features (file system, network). 
    In our small demo, resources are written as `?size`.
    
    </div><div class="col-sm-6">
    <h3 style="margin-top:0px">Dataflow language</h3>
    
    The second demo is a simple 
    <abbr title="The demo is inspired by the synchronous dataflow language Lustre introduced by Halbwachs et al. (1991)">
    dataflow language</abbr> where all variables represent _streams_ of values
    and you can access previous value using the `prev` keyword. For example `(x + prev x) / 2`
    calculates the average over the current and previous value. Here, coeffects track how many
    past values you need.
          
    </div></div>
    <div class="ia-choice ia-ui-bar-right" data-ia-undoable="true" data-ia-key="ch7" data-ia-ui-kind="circle" data-ia-ui-prop="border-color" data-ia-show="langs-info" data-ia-hide="">
    <div class="row callout" id="playground-callout">
    <div class="col-sm-12"><h3 style="margin:5px 0px 15px 15px;">How does the coeffect playground work?</h3></div>
    <div class="col-sm-4" style="padding-left:30px">
    <i class="fa fa-check-circle" style="color:#FB8072"></i> 
    
    **You choose a snippet. Coeffect system checks it.**
    
    <p class="ia" data-ia-key="langs-info" data-ia-mode="long">
    The system infers the names of the required implicit parameters
    or the required number of past values in the input streams.</p>
    
    </div><div class="col-sm-4" style="padding-left:30px">
    <i class="fa fa-arrow-circle-right" style="color:#80B1D3"></i> 
 
    **Behind the scenes, the snippet is <abbr title="Translated into a plain language.">desugared</abbr>.**
    
    <p class="ia" data-ia-key="langs-info" data-ia-mode="long">
    In the translated code, implicit parameters are passed around as 
    dictionaries and streams become lists of values.</p>
    
    </div><div class="col-sm-4" style="padding-left:30px">      
    <i class="fa fa-play-circle" style="color:#FDB462"></i> 

    **Enter inputs and run the code. It cannot fail!**
    
    <p class="ia" data-ia-key="langs-info" data-ia-mode="long">
    The coeffect type system guarantees that program accesses only the values that
    it asks for and so the program runs correctly!</p>
    
    </div></div></div>    
    <<<<

    
    </div>
  </div>
  <div class="container coeff-demo" data-coeff-mode="flat" data-coeff-kind="implicit" id="impl1">
    <div class="row">
      <div class="col-md-6">
        >>>>
        
        ### Implicit parameters
        
        Implicit parameters are the simplest example to show how resource tracking works.
        In a langauge with implicit parameters you can use `?foo`
        
            fun x -> x + ?y
        
        They are both lexically and dynamically scoped
        
            let f = (fun x -> x + ?y)
            let ?y = 10 in f 5
    
        but you can also write

            let f = 
              let ?y = 10 in
              (fun x -> x + ?y) in
            f 5        
        
        Check out some more examples!
        <<<<
        
      </div>
      <div class="col-md-6">
        <br /><br /><br />
        
        <textarea class="form-control" id="impl1-input" style="font-family:inconsolata; height:150px">
foo</textarea>
        <button class="btn btn-success" id="impl1-btn">Do stuff</button>
        <div id="impl1-playground">
        </div>
        <pre id="impl1-output">(Output goes here...)</pre>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <p id="impl1-judgement"></p>
        <p id="impl1-judgement-temp" style="display:none"></p>
      </div>
    </div>
  </div>
</div>


<div class="outline" style="margin-top:200px">
  <div class="body container">
    <h2><a name="typesystem">Type systems</a></h2>
  </div>
</div>
<div class="body container">
        

<div class="row">
<div class="col-sm-2"></div>
<div class="col-sm-8 lside">

Coeffect type system
--------------------

Long scrolling text here... Ovi lispmd idr. Blah goo bar foor foo.  Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo.


Long scrolling text here... Ovi lispmd idr. Blah goo bar foor foo.  Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo.

</div>
</div>

<div class="row">
<div class="col-sm-2"></div>
<div class="col-sm-8">

<div style="font-size:16pt;background:black;margin:20px;color:white;padding:40px">
<div style="width:0;height:0;border-style:solid;border-width:25px 35px 25px 0;border-color: transparent white transparent transparent;">
</div>

$$$
\definecolor{eff}{RGB}{255,107,102}
\definecolor{coeff}{RGB}{78,206,88}
\definecolor{typ}{RGB}{255,202,79}
\definecolor{kvd}{RGB}{127,165,255}

<h3>Plan langauge</h3>

$$$
\dfrac
  {\Gamma, x:{\color{ltyp} \tau_1} \vdash e : {\color{ltyp} \tau_2}}
  {\Gamma \vdash {\color{lkvd} \text{fun}}~x \rightarrow e : {\color{ltyp} \tau_1} \rightarrow {\color{ltyp} \tau_2}}

<h3>Effect systems</h3>

$$$
\dfrac
  {\Gamma, x:{\color{ltyp} \tau_1} \vdash e : {\color{ltyp} \tau_2 } {\scriptsize \;\&\;} {\color{leff} r} }
  {\Gamma \vdash {\color{lkvd} \text{fun}}~x \rightarrow e : {\color{ltyp} \tau_1} \xrightarrow{~\color{leff} r~} {\color{ltyp} \tau_2} {\scriptsize \;\&\;} {\color{leff} \emptyset}}

<h3>Coeffect systems</h3>

$$$
\dfrac
  {\Gamma, x:{\color{ltyp} \tau_1} {\scriptsize \;@\;} {\color{lcoeff} r\bullet s} \vdash e : {\color{ltyp} \tau_2 } }
  {\Gamma {\scriptsize \;@\;} {\color{lcoeff} r} \vdash {\color{lkvd} \text{fun}}~x \rightarrow e : {\color{ltyp} \tau_1} \xrightarrow{~\color{lcoeff} s~} {\color{ltyp} \tau_2}}

</div>

</div>
</div>
<div class="row">
<div class="col-sm-2"></div>
<div class="col-sm-8">

Long scrolling text here... Ovi lispmd idr. Blah goo bar foor foo.  Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo.


</div>
</div>
<div class="row">
<div class="col-sm-6">

### Implicit parameters

Long scrolling text here... Ovi lispmd idr. Blah goo bar foor foo.  Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo.

</div>
<div class="col-sm-6">

### Dataflow programming

Long scrolling text here... Ovi lispmd idr. Blah goo bar foor foo.  Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo.

</div>
</div>
<div class="row">
<div class="col-sm-2"></div>
<div class="col-sm-8">

Write program in a coeffect language

It gets type checked using coeffect type system
- We know it is correct!

We translate it into plain language
and you can run it!
  
  
Unified abstraction!!!  
  
  
Long scrolling text here... Ovi lispmd idr. Blah goo bar foor foo.  Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo. Ovi lispmd idr. Blah goo bar foor foo.
  
  
</div>
</div>
<div class="container coeff-demo" data-coeff-mode="structural" data-coeff-kind="dataflow" id="df1">
  <div class="row">
    <div class="col-md-6">
      <textarea class="form-control" id="df1-input" style="font-family:inconsolata; height:150px">fun x -> fun y -> x + prev y</textarea>
      <button class="btn btn-success" id="df1-btn">Do stuff</button>
      <div id="df1-playground">
      </div>
    </div>
    <div class="col-md-6">
      <pre id="df1-output">(Output goes here...)</pre>
      <pre id="df1-transl">(Output goes here...)</pre>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12">
      <p id="df1-judgement"></p>
      <p id="df1-judgement-temp" style="display:none"></p>
    </div>
  </div>
</div>

<<<<
  
</div>
</body>
</html>
